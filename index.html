<!DOCTYPE html>
<html lang="it" class="h-100">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Imbriani Stefano Noleggio</title>
  <meta name="description" content="Imbriani Stefano Noleggio - Sistema di prenotazione pulmini 9 posti. Percorsi per nuovi clienti e clienti esistenti.">
  <meta name="theme-color" content="#0066FF">
  <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üöê</text></svg>">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css?v=8006">
</head>
<body class="d-flex flex-column h-100">

<!-- Hero Section con Due Percorsi -->
<main class="flex-shrink-0">
  <div class="hero-section bg-gradient position-relative overflow-hidden">
    <div class="container position-relative z-2 py-5">
      <!-- Header -->
      <div class="text-center mb-5 animate-fade-in-up">
        <div class="d-flex align-items-center justify-content-center mb-4">
          <div class="bg-white rounded-circle p-3 shadow-sm me-3" style="width: 80px; height: 80px;">
            <i class="fas fa-van-shuttle text-primary" style="font-size: 2.5rem;"></i>
          </div>
          <div class="text-start">
            <h1 class="display-1-modern hero-title mb-1">Imbriani Stefano</h1>
            <p class="lead-modern mb-0">Noleggio Pulmini Professionale</p>
          </div>
        </div>
        <p class="lead text-white-50 lh-base">
          Scegli il percorso pi√π adatto alle tue esigenze
        </p>
      </div>
      
      <!-- Due Sezioni Principali -->
      <div class="row g-5 justify-content-center">
        <!-- NUOVI CLIENTI -->
        <div class="col-lg-5">
          <div class="glass-card p-5 h-100 text-center animate-fade-in-up">
            <div class="mb-4">
              <div class="bg-success bg-gradient rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 80px; height: 80px;">
                <i class="fas fa-user-plus text-white fs-1"></i>
              </div>
              <h3 class="fw-bold mb-3">Nuovi Clienti</h3>
              <p class="text-white-50 mb-4 lh-base">
                Prima volta con noi? Ti guidiamo step-by-step per trovare la soluzione perfetta.
              </p>
            </div>
            
            <div class="mb-4">
              <h6 class="fw-semibold mb-3 text-success">
                <i class="fas fa-route me-2"></i>
                Il tuo percorso in 5 step:
              </h6>
              <div class="text-start">
                <div class="d-flex align-items-center mb-2">
                  <span class="badge bg-success me-3" style="width: 24px; height: 24px; border-radius: 50%; font-size: 0.75rem;">1</span>
                  <small class="text-white-75">Verifica disponibilit√†</small>
                </div>
                <div class="d-flex align-items-center mb-2">
                  <span class="badge bg-success me-3" style="width: 24px; height: 24px; border-radius: 50%; font-size: 0.75rem;">2</span>
                  <small class="text-white-75">Scegli il pulmino</small>
                </div>
                <div class="d-flex align-items-center mb-2">
                  <span class="badge bg-success me-3" style="width: 24px; height: 24px; border-radius: 50%; font-size: 0.75rem;">3</span>
                  <small class="text-white-75">Richiedi preventivo</small>
                </div>
                <div class="d-flex align-items-center mb-2">
                  <span class="badge bg-success me-3" style="width: 24px; height: 24px; border-radius: 50%; font-size: 0.75rem;">4</span>
                  <small class="text-white-75">Dati autisti (1-3)</small>
                </div>
                <div class="d-flex align-items-center mb-3">
                  <span class="badge bg-success me-3" style="width: 24px; height: 24px; border-radius: 50%; font-size: 0.75rem;">5</span>
                  <small class="text-white-75">Conferma (email opzionale)</small>
                </div>
              </div>
            </div>
            
            <div class="d-grid">
              <button type="button" class="btn-premium" id="startNewFlow">
                <i class="fas fa-play me-2"></i>
                Inizia Verifica Disponibilit√†
              </button>
            </div>
          </div>
        </div>
        
        <!-- CLIENTI ESISTENTI -->
        <div class="col-lg-5">
          <div class="glass-card p-5 h-100 text-center animate-fade-in-up animation-delay-100">
            <div class="mb-4">
              <div class="bg-primary bg-gradient rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 80px; height: 80px;">
                <i class="fas fa-users text-white fs-1"></i>
              </div>
              <h3 class="fw-bold mb-3">Clienti Esistenti</h3>
              <p class="text-white-50 mb-4 lh-base">
                Hai gi√† prenotato con noi? Accedi rapidamente alla tua area riservata.
              </p>
            </div>
            
            <div class="mb-4">
              <div class="alert alert-info border-0" style="background: rgba(0, 102, 255, 0.15); border-radius: 12px;">
                <i class="fas fa-info-circle me-2"></i>
                <small>Dopo l'accesso potrai creare nuove prenotazioni a tuo nome e gestire quelle esistenti.</small>
              </div>
            </div>
            
            <div class="d-grid gap-3">
              <button type="button" class="btn btn-outline-light btn-lg" style="border-radius: 12px; font-weight: 600;" data-bs-toggle="modal" data-bs-target="#loginModal">
                <i class="fas fa-user-circle me-2"></i>
                Accedi con Codice Fiscale
              </button>
              
              <div class="text-center mt-3">
                <small class="text-white-50">
                  <i class="fas fa-shield-alt me-1"></i>
                  Accesso sicuro e protetto
                </small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Decorazioni di sfondo -->
    <div class="position-absolute top-0 end-0 w-50 h-100 opacity-10">
      <svg width="100%" height="100%" viewBox="0 0 400 400" fill="none">
        <defs>
          <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
            <path d="M 40 0 L 0 0 0 40" fill="none" stroke="white" stroke-width="1" opacity="0.3"/>
          </pattern>
        </defs>
        <rect width="100%" height="100%" fill="url(#grid)" />
      </svg>
    </div>
  </div>
</main>

<!-- Modal Login Clienti Esistenti -->
<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content shadow">
      <div class="modal-header border-0 pb-0">
        <h1 class="modal-title fs-4 fw-bold text-white" id="loginModalLabel">
          <i class="fas fa-user-circle text-primary me-2"></i>
          Accesso Clienti Esistenti
        </h1>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Chiudi"></button>
      </div>
      <div class="modal-body px-4 py-4">
        <form id="loginForm">
          <div class="mb-4">
            <label for="codiceFiscale" class="form-label fw-semibold text-white">Codice Fiscale</label>
            <input type="text" class="form-control-modern" id="codiceFiscale" maxlength="16" 
                   placeholder="RSSMRA80A01H501Z" style="text-transform: uppercase;" required>
            <div class="form-text">
              <i class="fas fa-info-circle me-1"></i>
              Inserisci il tuo CF per accedere all'area personale
            </div>
          </div>
          
          <div class="d-grid gap-3">
            <button type="submit" class="btn-premium" id="loginBtn">
              <span class="spinner-border spinner-border-sm me-2 d-none" id="loginSpinner" role="status"></span>
              <i class="fas fa-sign-in-alt me-2" id="loginIcon"></i>
              <span id="loginText">Accedi all'Area Personale</span>
            </button>
          </div>
        </form>
        
        <div class="text-center mt-4 pt-3" style="border-top: 1px solid rgba(255, 255, 255, 0.1);">
          <p class="text-white-50 small mb-0">
            <i class="fas fa-shield-alt me-1"></i>
            I tuoi dati sono protetti con crittografia SSL
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Stepper Modal per Nuovi Clienti -->
<div class="modal fade" id="newFlowModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content shadow">
      <div class="modal-header border-0">
        <h1 class="modal-title fs-4 fw-bold text-white" id="newFlowTitle">Verifica Disponibilit√†</h1>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Chiudi"></button>
      </div>
      <div class="modal-body p-4" id="newFlowBody">
        <!-- Content dinamico step-by-step -->
      </div>
      <div class="modal-footer border-0">
        <button type="button" class="btn btn-outline-light" id="newPrev" disabled>
          <i class="fas fa-arrow-left me-2"></i>Indietro
        </button>
        <div class="d-flex align-items-center gap-3">
          <div class="form-check me-2 d-none" id="emailOptinWrap">
            <input class="form-check-input" type="checkbox" id="emailOptin">
            <label class="form-check-label text-white" for="emailOptin">
              <i class="fas fa-envelope me-1"></i>
              Ricevi aggiornamenti via email
            </label>
          </div>
          <button type="button" class="btn-premium" id="newNext">
            Avanti
            <i class="fas fa-arrow-right ms-2"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Area Personale (inizialmente nascosta) -->
<div id="personalArea" class="d-none">
  <div class="container-fluid px-3 px-lg-4 py-4">
    <!-- Area personale content will be dynamically loaded -->
    <div class="glass-card p-4">
      <h3 class="fw-bold mb-3 text-white">
        <i class="fas fa-user-circle text-primary me-2"></i>
        Area Personale
      </h3>
      <p class="text-white-50">Benvenuto nella tua area riservata.</p>
      <div class="d-flex gap-3 mt-4">
        <button class="btn-premium" id="newBookingForClient">
          <i class="fas fa-plus me-2"></i>
          Nuova Prenotazione
        </button>
        <button class="btn btn-outline-light" id="viewMyBookings">
          <i class="fas fa-list me-2"></i>
          Le Mie Prenotazioni
        </button>
        <button class="btn btn-outline-secondary" id="logoutBtn">
          <i class="fas fa-sign-out-alt me-2"></i>
          Esci
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Footer -->
<footer class="bg-dark text-white py-4 mt-auto" style="background: var(--dark-card) !important; border-top: 1px solid rgba(255, 255, 255, 0.1);">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-6">
        <div class="d-flex align-items-center">
          <i class="fas fa-van-shuttle text-primary me-3 fs-4"></i>
          <div>
            <h6 class="mb-0 fw-bold text-white">Imbriani Stefano Noleggio</h6>
            <small class="text-white-50">Il tuo partner per la mobilit√† in Puglia</small>
          </div>
        </div>
      </div>
      <div class="col-md-6 text-md-end mt-3 mt-md-0">
        <div class="d-flex flex-column align-items-md-end">
          <div class="mb-2">
            <a href="tel:+393286589618" class="text-white text-decoration-none me-3 link-primary">
              <i class="fas fa-phone me-1"></i> +39 328 658 9618
            </a>
            <a href="mailto:info@imbrianinoleggio.it" class="text-white text-decoration-none link-primary">
              <i class="fas fa-envelope me-1"></i> info@imbrianinoleggio.it
            </a>
          </div>
          <small class="text-white-50">&copy; 2025 Tutti i diritti riservati</small>
        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Toast Container -->
<div class="toast-container position-fixed bottom-0 end-0 p-3">
  <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="toast-header">
      <i class="fas fa-info-circle text-primary me-2" id="toastIcon"></i>
      <strong class="me-auto" id="toastTitle">Notifica</strong>
      <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Chiudi"></button>
    </div>
    <div class="toast-body" id="toastBody"></div>
  </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="config.js"></script>
<script src="shared-utils.js"></script>
<script src="format-helpers.js"></script>
<script src="scripts.js"></script>
<script src="booking-submit.js"></script>
<script src="safe-whatsapp-fix.js"></script>
<script src="whatsapp-loader.js"></script>
<script src="loader-diagnostics.js?v=8"></script>
<script>if(window.bindCFHandlers) bindCFHandlers();</script>

</body>
</html>