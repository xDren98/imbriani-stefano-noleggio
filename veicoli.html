async function searchAvailableVehicles() {
  try {
    const vehiclesResponse = await api.call({ action: 'getVeicoli' });
    if (!vehiclesResponse.success) { 
      if (window.showToast) showToast('Errore caricamento veicoli', 'error'); 
      return; 
    }
    const allVehicles = vehiclesResponse.data || [];
    console.log('ðŸš— Veicoli totali:', allVehicles.length);
    availableVehicles = [];

    // ðŸš€ Parallellizza tutte le chiamate checkDisponibilita
    const checkPromises = allVehicles.map(v => {
      const checkUrl = `${CONFIG.API_URL}?action=checkDisponibilita&targa=${encodeURIComponent(v.Targa)}&dataInizio=${encodeURIComponent(selectedDates.dataInizio)}&dataFine=${encodeURIComponent(selectedDates.dataFine)}&oraInizio=${encodeURIComponent(selectedDates.oraRitiro)}&oraFine=${encodeURIComponent(selectedDates.oraRiconsegna)}&token=${encodeURIComponent(CONFIG.TOKEN)}`;
      return fetch(checkUrl)
        .then(r => r.json())
        .then(checkResp => ({ v, checkResp }))
        .catch(err => { console.error(`Errore check ${v.Targa}:`, err); return null; });
    });

    const results = (await Promise.all(checkPromises)).filter(res => res && res.checkResp && res.checkResp.success);
    availableVehicles = results.filter(res => res.checkResp.disponibile).map(res => res.v);
    console.log('âœ… Veicoli disponibili:', availableVehicles.length);
    displayVehicleResults();
  } catch (err) {
    console.error('Errore ricerca:', err);
    if (window.showToast) showToast('Errore ricerca veicoli', 'error');
  }
}
